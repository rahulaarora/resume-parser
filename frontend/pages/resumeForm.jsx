import Head from "next/head";
import { useState } from "react";
import { useRouter } from 'next/router'

let userObj = {
    userName: "",
    email: "",
    mobileNumber: "",
    education: "",
    skills: "",
    companyName: "",
    collegeName: "",
    designation: "",
    experience: "",
    linkedIn:""
}

function resumeForm() {

    const [user, setUser] = useState(userObj);
    const router = useRouter();

    function changeHandler(e) {
        setUser({
            ...user,
            [e.target.name]: e.target.value
        });
    }

    async function submitHandler(e) {
        alert("Submitting!");
        e.preventDefault();
        const response = await fetch("/api/formUpload", {
            method: "POST",
            body: JSON.stringify(user),
            headers: {
                "Content-Type": "application/json",
            },
        });

        const res = await response.json();
        res.success == true ? alert("Form submitted successfully!") : alert("Failed, Try again!");
        router.reload();

    }

    return (
        <>
            <Head>
                <title>Manual Form</title>
                <meta name="description" content="Generated by create next app" />
                <link rel="icon" href="/favicon.ico" />
            </Head>

            <main className="container-fluid py-5">
                <form className="col-5 mx-auto" onSubmit={submitHandler} method={"POST"} encType="multipart/form-data" >
                    <h6>Enter Details:</h6>
                    {/* <input type={"text"} required name="userName" value={user.userName} onChange={changeHandler} /> */}

                    <div className="d-flex flex-column">
                        <input required type="text" name="userName"
                            id="name" placeholder="Enter Your Full name*" className="my-2" value={user.userName} onChange={changeHandler}/>


                        <input required type="email" name="email"
                            id="name" placeholder="Enter Your Valid Email*" className="my-2" value={user.email} onChange={changeHandler}/>


                        <input type="tel" name="mobileNumber"
                            id="name" placeholder="Enter Your Mobile Number" className="my-2" value={user.mobileNumber} onChange={changeHandler}/>


                        <input type="text" name="education"
                            id="name" placeholder="Enter your Highest Education" className="my-2" value={user.education} onChange={changeHandler}/>


                        <input required type="text" name="skills"
                            id="name" placeholder="Enter your skills separated with comma*" className="my-2" value={user.skills} onChange={changeHandler}/>


                        <input type="text" name="companyName"
                            id="name" placeholder="Enter your current Company Name" className="my-2" value={user.companyName} onChange={changeHandler}/>


                        <input type="text" name="collegeName"
                            id="name" placeholder="Enter your College Name" className="my-2" value={user.collegeName} onChange={changeHandler}/>


                        <input type="text" name="designation"
                            id="name" placeholder="Enter your Designation" className="my-2" value={user.designation} onChange={changeHandler}/>


                        <input type="number" name="experience"
                            id="text" placeholder="Enter your Experience" className="my-2" value={user.experience} onChange={changeHandler}/>


                        <input type="url" name="linkedIn"
                            id="name" placeholder="Enter the Valid URL" className="my-2" value={user.linkedIn} onChange={changeHandler}/>


                    </div>

                    <button type="submit" className="d-block my-4 btn btn-outline-success">
                        Submit
                    </button>
                </form>
            </main>
        </>
    );
}

export default resumeForm;